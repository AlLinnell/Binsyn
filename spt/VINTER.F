      SUBROUTINE VINTER(PHS,VLT,VLC,PSJ,VCLC,SMC,SME,LDF,NRY,LST,KSP,
     $KPT,L,KCT,NOUT)
	INCLUDE 'COMA.FOR'
      DIMENSION PSJ(MPHS),VCLC(MPHS),HARA(MPHS),HARB(MPHS),HARE(MPHS)
      DIMENSION HARC(4*MPHS),HARD(4*MPHS),HARF(4*MPHS),HARG(4*MPHS)
      DIMENSION SMC(MPHS),SME(MPHS),AR4(MTR),AD(MSX)
      DIMENSION KCT(13)
      IF (LDF.EQ.1) GO TO 10
      IF ((NRY.GT.1).AND.(NRY.LT.3)) CALL PMDSTOP
      DO 20 K=1,NRY
      HARA(K)=PSJ(K+LST-1)
      HARB(K)=VCLC(K+LST-1)
      IF (KSP.EQ.2) GO TO 21
      HARE(K)=SMC(K+LST)
      GO TO 20
   21 HARE(K)=SME(K+LST)
   20 CONTINUE
      LMT=NRY-1
      DF=HARA(2)-HARA(1)
      DO 22 K=2,LMT
      DFC=HARA(K+1)-HARA(K)
      IF (DABS(DFC-DF).GT.0.0000005D0) CALL PMDSTOP
   22 CONTINUE
      LG=NRY*3
      IF (LMT.GT.3) LMT=3
      CALL DFB(HARB,HARC,NRY,LG,LMT)
      IF (KPT.EQ.0) GO TO 23
      IF (KCT(L).GT.0) GO TO 23
      CALL PDFB(HARA,HARB,HARC,AR4,NRY,LG,LMT,NOUT)
   23 CALL DFF(HARB,HARD,NRY,LG,LMT)
      IF (KPT.EQ.0) GO TO 24
      IF (KCT(L).GT.0) GO TO 24
      CALL PDFF(HARA,HARB,HARD,AR4,NRY,LG,LMT,NOUT)
   24 KCT(L)=KCT(L)+1
      CALL DFB(HARE,HARF,NRY,LG,LMT)
      CALL DFF(HARE,HARG,NRY,LG,LMT)
C     Set LDF to force production of difference table at
C     each entry, permitting phases of observation to be
C     random.
      LDF=0
   10 IF (2.D0*PHS.GT.(HARA(1)+HARA(NRY))) GO TO 11
      CALL INF(PHS,HARA,HARB,HARD,AD,NRY,LG,LMT,CG,U,VLT)
      CALL INF(PHS,HARA,HARE,HARG,AD,NRY,LG,LMT,CG,U,VLC)
      GO TO 25
   11 CALL INB(PHS,HARA,HARB,HARC,AD,NRY,LG,LMT,CG,U,VLT)
      CALL INB(PHS,HARA,HARE,HARF,AD,NRY,LG,LMT,CG,U,VLC)
   25 CONTINUE
      END
