      PROGRAM LDARK
C     VERSION OF 9/7/85
C     PROGRAM TO READ INPUT DATA,SUCH AS CARBON-GINGERICH TABLES,
C     AND PRODUCE OUTPUT TABLES OF LIMB DARKENING COEFFICIENTS
C     THE OUTPUT TABLES CONTAIN QUADRATIC COEFFICIENTS
C     NGR=NUMBER OF INPUT GRAVITY VALUES
C     NTMP=NUMBER OF INPUT TEMPERATURE VALUES
C     NRF=NUMBER OF INPUT WAVELENGTH VALUES
C     LSGR=ORDINAL LOCATION OF STARTING GRAVITY VALUE IN INPUT
C     LSTMP=ORDINAL LOCATION OF STARTING TEMP. VALUE IN INPUT
C     NOG=NUMBER OF OUTPUT GRAVITY VALUES AFTER FILLING TABLE
C     NOT=NUMBER OF OUTPUT TEMPERATURE VALUES AFTER FILLING TABLE
C     NOR=NUMBER OF OUTPUT WAVELENGTH VALUES AFTER FILLING TABLE
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      DIMENSION U1R(10,22,14),U2R(10,22,14),KRY(14) 
	DIMENSION FL1(3)
	DATA IN1,IN2,NOUT/1,3,2/
	CHARACTER *24 FL1
  100 FORMAT (14F6.3)   
  101 FORMAT (1X,14F7.3)
  102 FORMAT (14I5)     
  103 FORMAT (' ')      
  104 FORMAT (14I6)
  105 FORMAT (A24)
C*********************************************************************
	OPEN (UNIT=4, FILE='C:\LGTSYN\LDARK\LDARK.ILS', STATUS='OLD')
	READ (4, 105) (FL1(J),J=1,3)
	OPEN (UNIT=IN1,  FILE=FL1(1), STATUS='OLD')
	OPEN (UNIT=IN2,  FILE=FL1(2), STATUS='OLD')
	OPEN (UNIT=NOUT, FILE=FL1(3), STATUS='REPLACE')
C********************************************************************* 
      READ (1,102) NGR,LSGR,NOG,NTMP,LSTMP,NOT,NRF,NOR
      LNGR=LSGR+NGR-1   
      LNTP=LSTMP+NTMP-1 
      DO 30 J=LSGR,LNGR 
      DO 20 K=LSTMP,LNTP
      READ (3,104) (KRY(L),L=1,NRF)    
      DO 1 L=1,NRF
      V=KRY(L)   
      U1R(J,K,L)=V/1000.0      
    1 CONTINUE   
      IF (NRF.GE.14) GO TO 3
      NST=NRF+1
      DO 4 L=NST,14
      U1R(J,K,L)=U1R(J,K,NRF)
    4 CONTINUE
    3 READ (3,104) (KRY(L),L=1,NRF)    
      DO 2 L=1,NRF
      V=KRY(L)   
      U2R(J,K,L)=V/1000.0      
    2 CONTINUE   
      IF (NRF.GE.14) GO TO 20
      NST=NRF+1
      DO 5 L=NST,14
      U2R(J,K,L)=U2R(J,K,NRF)
    5 CONTINUE
   20 CONTINUE   
      KLT=LSTMP-1
      IF (LSTMP.LE.1) GO TO 23 
      DO 22 K=1,KLT     
      DO 21 L=1,14      
      U1R(J,K,L)=U1R(J,LSTMP,L)
      U2R(J,K,L)=U2R(J,LSTMP,L)
   21 CONTINUE   
   22 CONTINUE   
   23 IF (LNTP.EQ.22) GO TO 30 
      KLT=LNTP+1 
      DO 25 K=KLT,22    
      DO 24 L=1,14      
      U1R(J,K,L)=U1R(J,LNTP,L) 
      U2R(J,K,L)=U2R(J,LNTP,L) 
   24 CONTINUE   
   25 CONTINUE   
   30 CONTINUE   
      KLT=LSGR-1 
      IF (LSGR.LE.1) GO TO 34  
      DO 33 J=1,KLT     
      DO 32 K=1,22      
      DO 31 L=1,14      
      U1R(J,K,L)=U1R(LSGR,K,L) 
      U2R(J,K,L)=U2R(LSGR,K,L) 
   31 CONTINUE   
   32 CONTINUE   
   33 CONTINUE   
   34 KLT=LNGR+1 
      IF (LNGR.EQ.10) GO TO 40 
      DO 37 J=KLT,10    
      DO 36 K=1,22      
      DO 35 L=1,14      
      U1R(J,K,L)=U1R(LNGR,K,L) 
      U2R(J,K,L)=U2R(LNGR,K,L) 
   35 CONTINUE   
   36 CONTINUE   
   37 CONTINUE   
   40 DO 42 J=1,NOG     
      DO 41 K=1,NOT     
      WRITE (2,101) (U1R(J,K,L),L=1,NOR)     
      WRITE (2,101) (U2R(J,K,L),L=1,NOR)     
   41 CONTINUE   
   42 CONTINUE
      CLOSE (UNIT=1,  STATUS='KEEP')
	CLOSE (UNIT=2,  STATUS='KEEP')
	CLOSE (UNIT=3,  STATUS='KEEP')   
      STOP
      END PROGRAM LDARK
