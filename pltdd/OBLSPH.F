      SUBROUTINE OBLSPH(THV,A,B,R,ZETA,BETA)
	IMPLICIT DOUBLE PRECISION(A-H,O-Z)
	DATA PIO2/1.5707963267948966192D0/
	E=B/A
	E2=E*E
	A2=A*A
	B2=B*B
	C=(1.D0-E2)/E2
	IF (THV.NE.PIO2) THEN
		D=DTAN(THV)
	ELSE
		D=1.D88
	END IF
	D2=D*D
	F=1.D0+E2*D2
	R2=A2-C*B2/F
	R=DSQRT(R2)
	IF (D.NE.0.D0) THEN
		ZETA=DATAN(A2/B2/D)
	ELSE
		ZETA=PIO2
	END IF
	BETA=ZETA+THV-PIO2
	RETURN
	END
