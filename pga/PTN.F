      SUBROUTINE PTN(I,X,Y,Z,ER,LM)   
C     THIS SRT CALCULATES THE Z VALUE FOR ASSIGNED X AND Y,ON THE CONDIT  
C     ION THE POINT LIES ON THE SURFACE OF POTENTIAL OM(I) 
C     THE SRT TRANSMITS THE X AND Y VALUES TO VARIOUS SRT,S VIA VX(I)    
C     AND VYZ(I) 
C     THE OUTPUT Z IS RETURNED IN THE CALLING SEQUENCE PARAMETER  
C     NOTE THAT THE MAXIMUM PERMITTED Z,BY THE SRT,IS 0.8  
C     THE ERROR LIMIT TO SRT NWRP IS RECEIVED VIA EL
C     THE MAXIMUM NUMBER OF ITERATIONS FOR NWRP IS RECEIVED VIA M(2)     
      INCLUDE 'COMA.FOR'
      EXTERNAL OMX,OMXP,OMXPP
	DATA ERLT/1.D-13/  
      VX(I)=X    
      VYZ(I)=Y   
      J=1 
      SZ=0.01D0
      TZ=0.05D0  
    4 CALL OMX(I,SZ,E1)    
      IF (DABS(E1).LE.ERLT) GO TO 11  
      CALL OMX(I,TZ,E2)    
      IF (DABS(E2).LE.ERLT) GO TO 12  
      IF (E1.GT.0.D0) GO TO 5   
C     IF E1 IS -,SZ IS TOO LARGE      
      TZ=SZ      
      SZ=0.25D0*SZ 
      J=J+1      
      IF (J.LT.10) GO TO 4     
      CALL PMDSTOP      
    5 IF (E2.LT.0.D0) GO TO 10  
C     IF E2 IS +,TZ IS TOO SMALL      
      SZ=TZ      
      TZ=2.D0*TZ  
      J=J+1      
      IF (J.LT.6) GO TO 4      
      CALL PMDSTOP      
   11 Z=SZ
      GO TO 6    
   12 Z=TZ
      GO TO 6    
   10 CALL NWRP(SZ,TZ,I,1,1,Z,OMX,OMXP,OMXPP,ER,LM) 
    6 RETURN     
      END 
