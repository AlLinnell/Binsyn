      SUBROUTINE TPL(I,ITH,KRY,KND,VPHV,RT,ARR3,MRY,N)
C     SRT TO INTERPOLATE AN ORDINATE FROM THE ARRAY OF KNOWN ORDINATES,  
C     TO ALLOW INTEGRATION USING SIMPSONS RULE      
      INCLUDE 'COMA.FOR'
      DIMENSION ARA(MSX),ARB(MSX),ARR3(MRY)
C     MUST BE ABLE TO FIT POLYNOMIAL TO AT LEAST SIX POINTS
      IF (N.LT.6) CALL PMDSTOP
      V=1.1D0
      KK=KND-N+1 
      L=KK
      IF (VPHV.LT.ARR3(1)) V=-1.1D0
      IF (VPHV.LT.ARR3(1)) GO TO 5      
      L=KND-1    
      DO 1 K=KK,L
      IF (VPHV.EQ.ARR3(K-KK+1)) GO TO 10
      IF ((VPHV.GT.ARR3(K-KK+1)).AND.(VPHV.LT.ARR3(K-KK+2)))GO TO 2   
    1 CONTINUE   
      K=KND      
C     TEST WHETHER VPHV EQUALS LAST TABLE ENTRY.
C     IF NOT,IT LIES BEYOND LAST TABLE ENTRY.
      IF (VPHV.EQ.ARR3(K-KK+1)) GO TO 10
C     ESTABLISH SIX POINTS TO WHICH POLYNOMIAL MAY BE FITTED
C     L IS ORDINAL LOCATION OF FIRST POINT IN FITTING ARRAY
    2 L=K-3
    3 L=L+1      
      IF (L.GE.KK) GO TO 4     
      GO TO 3    
    4 IF ((L+5).LE.KND) GO TO 5      
      L=L-1      
      GO TO 4    
    5 DO 6 J=1,6
      ARA(J)=ARR3(L- KK+J)      
      IF (KRY.EQ.1) ARB(J)=DSG(I,ITH,L+J-1)      
      IF (KRY.EQ.2) ARB(J)=VL1(I,ITH,L+J-1)      
      IF (KRY.EQ.3) ARB(J)=VL2(I,ITH,L+J-1)      
      IF (KRY.EQ.4) ARB(J)=VL3(I,ITH,L+J-1)      
      IF (KRY.EQ.5) ARB(J)=PLA1(I,ITH,L+J-1)
      IF (KRY.EQ.6) ARB(J)=PLB1(I,ITH,L+J-1)
      IF (KRY.EQ.7) ARB(J)=PLU(I,ITH,L+J-1)
      IF (KRY.EQ.8) ARB(J)=PLTE(I,ITH,L+J-1)
    6 CONTINUE   
C     NOW HAVE PROPERLY CHOSEN SET OF SIX POINTS FOR USE WITH
C     SRT LAGIN
      CALL LAGIN(VPHV,RT,ARA,ARB,4,6,J,V)
      IF (J.GT.2) GO TO 9
      DO J=1,5
      IF ((VPHV.GT.ARA(J)).AND.(VPHV.LT.ARA(J+1))) GO TO 7
      END DO
      DO J=1,5
      IF ((VPHV.LT.ARA(J)).AND.(VPHV.GT.ARA(J+1))) GO TO 7
      END DO
      CALL PMDSTOP
    7 CALL LNTER(ARA(J),ARB(J),ARA(J+1),ARB(J+1),VPHV,RT)
    9 RETURN
   10 IF (KRY.EQ.1) RT=DSG(I,ITH,K)
      IF (KRY.EQ.2) RT=VL1(I,ITH,K)
      IF (KRY.EQ.3) RT=VL2(I,ITH,K)
      IF (KRY.EQ.4) RT=VL3(I,ITH,K)
      IF (KRY.EQ.5) RT=PLA1(I,ITH,K)
      IF (KRY.EQ.6) RT=PLB1(I,ITH,K)
      IF (KRY.EQ.7) RT=PLU(I,ITH,K)
      IF (KRY.EQ.8) RT=PLTE(I,ITH,K)
      GO TO 9    
      END 
