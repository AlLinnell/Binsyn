      SUBROUTINE OMX(I,Z,E)
C     THIS SRT CALCULATES THE POTENTIAL FOR ASSIGNED X,Y AND Z    
C     THE Z VALUE IS TRANSMITTED VIA THE CALLING SEQUENCE  
C     THE X VALUE IS TRANSMITTED VIA VX(I),  HAVING BEEN PLACED THERE    
C     BY SRT PTN 
C     THE Y VALUE SIMILARLY IS TRANSMITTED VIA VYZ(I)      
C     THE SRT RETURNS THE DIFFERENCE BETWEEN THE POTENTIAL CALCULATED    
C     AND THE CORRECT POTENTIAL,OM(I),VIA E  
      INCLUDE 'COMA.FOR'
      BKT1(1)=Z*Z+VX(I)*VX(I)+VYZ(I)*VYZ(I)  
      BKT1(2)=1.D0-2.D0*VX(I)+BKT1(1)   
      VOM=1.D0/DSQRT(BKT1(1))+Q*(1.D0/DSQRT(BKT1(2))-VX(I))+0.5D0*(1.  
     $D0+Q)*(VX(I)*VX(I)+VYZ(I)*VYZ(I))   
      E=VOM-OM(I)
      RETURN     
      END 
