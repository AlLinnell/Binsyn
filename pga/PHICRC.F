      SUBROUTINE PHICRC(I,ITH,NTH)
C     SRT TO SET PHI VALUES ON A GIVEN THETA CIRCLE,STARTING AT THE
C     NECK IN OVERCONTACT SYSTEMS
C     THIS SRT ALSO FILLS THE ARRAYS NPH AND NTL
      INCLUDE 'COMA.FOR'
      DIMENSION AR1(MPHM),AR4(MPHM)
C
      DATA PIO2/1.5707963267948966192D0/
	DATA TWPI/6.2831853071795864769D0/
      PHT=0.D0
      Y=YMN      
C     VW IS RADIAL DIST.TO POINT WHERE Z AXIS PIERCES MINIMUM NECK
      VW=XMN(I)/ALMX(I) 
      Z=VW*ANU(I,ITH,1)   
C     NORMAL PROCEDURE OUTSIDE NECK
      IF (Z.GE.ZMN) GO TO 3    
      IF (Z.LE.-ZMN) GO TO 3   
C     SPECIAL PROCEDURE FOR NECK
      A=XMN(I)/SNT(I,ITH)
      PHMN=0.D0
      PHMX=PIO2
      DPH=(PHMX-PHMN)/20.D0
      DO K=1,21
      AR1(K)=PHMN+(K-1)*DPH
      B=DCOS(AR1(K))
      RV=A/B
      C=SNT(I,ITH)*B
      CALL RCHA(I,ITH,1,RV,C,AR4(K))
      IF (AR4(K).LE.0.D0) GO TO 1
      END DO
      CALL PMDSTOP
    1 PHMN=AR1(K-1)
      PHMX=AR1(K)
      DPH=(PHMX-PHMN)/4.D0
      DO K=1,5
      AR1(K)=PHMN+(K-1)*DPH
      B=DCOS(AR1(K))
      RV=A/B
      C=SNT(I,ITH)*B
      CALL RCHA(I,ITH,1,RV,C,AR4(K))
      END DO
      CALL LAGIN(0.D0,PHT,AR4,AR1,4,5,KR,1.D0)
      IF (KR.LE.2) CALL PMDSTOP
    3 CONTINUE      
      N=NPH(I,ITH)      
      PH(I,ITH,1)=PHT     
      IF (ITH.EQ.1) GO TO 20
	IF (ITH.EQ.NTH) GO TO 20
C     Calculate range
      DPH=TWPI-PH(I,ITH,1)-PHT  
      DV=N-1     
      DO 30 K=1,N
      PH(I,ITH,K)=(K-1)/DV*DPH+PH(I,ITH,1)    
   30 CONTINUE   
   20 RETURN     
      END 
