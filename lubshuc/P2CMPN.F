      SUBROUTINE P2CMPN(X,Y,Z,VMU,VMOMU,VLI,DVLI,UX,UY,PP2TN)
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
C     Subroutine to calculate second derivative of potential with
C     respect to transverse coordinate n.
      CALL PPCMPX(X,Y,Z,VMU,VMOMU,PPOTX)
	CALL PPCMPY(X,Y,Z,VMU,VMOMU,PPOTY)
	CALL PP2CMPX(X,Y,Z,VMU,VMOMU,PP2TX)
	CALL PP2CMPY(X,Y,Z,VMU,VMOMU,PP2TY)
	CALL P2CMPXPY(X,Y,Z,VMU,VMOMU,PP2TXTY)
	SNI=DSIN(VLI)
	CSI=DCOS(VLI)
	BKT1=-PP2TX*SNI+PP2TXTY*CSI-PPOTY*SNI*DVLI/UX
	BKT2=-PP2TXTY*SNI-PPOTX*CSI*DVLI/UY+PP2TY*CSI
	PP2TN=-SNI*BKT1+CSI*BKT2
	RETURN
      END