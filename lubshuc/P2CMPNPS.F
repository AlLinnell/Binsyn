      SUBROUTINE P2CMPNPS(X,Y,Z,VMU,VMOMU,VLI,DVLI,UX,UY,UV,AX,AY,AS,
     $PP2TNTS)
C     Subroutine to calculate second derivative of potential w/resp to
C     S and transverse coordinate N.
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
	CALL PPCMPX(X,Y,Z,VMU,VMOMU,PPOTX)
	CALL PPCMPY(X,Y,Z,VMU,VMOMU,PPOTY)
	CALL PP2CMPX(X,Y,Z,VMU,VMOMU,PP2TX)
	CALL PP2CMPY(X,Y,Z,VMU,VMOMU,PP2TY)
	CALL P2CMPXPY(X,Y,Z,VMU,VMOMU,PP2TXTY)
	SNI=DSIN(VLI)
	CSI=DCOS(VLI)
	D2XDYDS=(UV*AX-UX*AS)/UV**2/UY-DVLI/UV
	D2YDXDS=(UV*AY-UY*AS)/UV**2/UX+DVLI/UV
	BKT1=PP2TX*UX/UV+PP2TXTY*UY/UV+PPOTY*D2YDXDS
	BKT2=PP2TXTY*UX/UV+PPOTX*D2XDYDS+PP2TY*UY/UV
	PP2TNTS=-BKT1*SNI+BKT2*CSI
	RETURN
	END