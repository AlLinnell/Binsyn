      SUBROUTINE RK4A(X,Y,Z,VLAMBDA1,VM1,B1,B2,UX,UY,YP,DYDX,N,H,YOUT)
	IMPLICIT DOUBLE PRECISION (A-H,O-Z)
	PARAMETER (NMAX=10)
	DIMENSION YP(N),DYDX(N),YOUT(N),YT(NMAX),DYT(NMAX),DYM(NMAX)
	HH=H*0.5D0
	H6=H/6.D0
	DO I=1,N
		YT(I)=YP(I)+HH*DYDX(I)
	END DO
	X=YT(1)
	Y=YT(2)
	UX=YT(3)
	UY=YT(4)
	CALL DVSA(X,Y,Z,VLAMBDA1,VM1,B1,B2,UX,UY,YP,DYT)
	DO I=1,N
		YT(I)=YP(I)+HH*DYT(I)
	END DO
	X=YT(1)
	Y=YT(2)
	UX=YT(3)
	UY=YT(4)
	CALL DVSA(X,Y,Z,VLAMBDA1,VM1,B1,B2,UX,UY,YT,DYM)
	DO I=1,N
		YT(I)=YP(I)+H*DYM(I)
		DYM(I)=DYT(I)+DYM(I)
	END DO
	X=YT(1)
	Y=YT(2)
	UX=YT(3)
	UY=YT(4)
	CALL DVSA(X,Y,Z,VLAMBDA1,VM1,B1,B2,UX,UY,YT,DYT)
	DO I=1,N
		YOUT(I)=YP(I)+H6*(DYDX(I)+DYT(I)+2.D0*DYM(I))
	END DO	   
	RETURN
	END