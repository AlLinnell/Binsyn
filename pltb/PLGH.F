      SUBROUTINE PLGH(IFC,ICOUNT,K2CT,LCT,XP,YP,CSPJ,SNPJ,AGLMT1,
     $AGLMT2,IRD,XG,YG,XCM,YCM,XNKSV2,YNKSV2,IEC,ISV,NOUT1,NOUT2)
	INCLUDE 'COMA.FOR'
      DIMENSION LCT(16)
      DATA PIO2/1.5707963267949D0/
      DATA PI/3.1415926535898D0/
      DATA TWPI/6.2831853071796D0/
      DATA ANG/6.29D0/
	DATA ERLT/1.D-13/
  193 FORMAT (3F12.5,I5)
C  
C*********************************************************************
C     PLOT THE LARGE THETA HORIZON POINTS
C*********************************************************************
C
      DO 321 J=1,IFC
      IF (ICOUNT.EQ.2) GO TO 210      
C     ECLIPSING STAR    
      IF (LCT(10).NE.1) GO TO 321     
      YP=YF(J)   
      XP=XF(J)   
      X=XP
      Y=YP
      IF (LCT(15).EQ.1) GO TO 77      
      Y=XP*CSPJ-YP*SNPJ
      X=XP*SNPJ+YP*CSPJ
      GO TO 310  
   77 CONTINUE   
      X=XP
      Y=YP
      GO TO 310  
C     ECLIPSED STAR     
  210 IF (LCT(2).NE.1) GO TO 321
      IF ((DABS(AGLMT1+ANG).LE.ERLT).AND.(DABS(AGLMT2+ANG).LE.ERLT)) 
     $GO TO 321
      YP=YF(J)   
      XP=XF(J)   
      X=XP
      Y=YP
      IF (LCT( 5).EQ.1) GO TO 308     
      IF (ISV.EQ.IEC) GO TO 280
      RDS=DSQRT(X**2+Y**2)      
C  Following section follows procedure in SRT RANGE
      ANGLE=0.0D0
      IF ((X.GE.0.0D0).AND.(DABS(Y).LE.ERLT)) ANGLE=PIO2
      IF (DABS(ANGLE-PIO2).LE.ERLT) GO TO 1136
      IF ((X.LT.0.0D0).AND.(DABS(Y).LE.ERLT)) ANGLE=-PIO2
      IF (DABS(ANGLE+PIO2).LE.ERLT) GO TO 1136
 1117 ANGLE=DACOS(Y/RDS)
      IF (IRD.EQ.-1) ANGLE=PI-ANGLE
      IF (X.LT.0.0D0) ANGLE=-ANGLE
 1136 CONTINUE
C     IF AGLMT1 AND AGLMT2 ARE ON THE LARGE THETA BRANCH,DO NOT PLOT
C     SMALL THETA BRANCH POINTS
C     NOTE THAT ANGLE MOVES THROUGH MORE NEGATIVE VALUES ON THE SMALL
C     THETA BRANCH
C     If AGLMT1.EQ.ANG,plot all points
      IF (DABS(AGLMT1-ANG).LE.ERLT) GO TO 308
      IF ((AGLMT1.LT.0.0D0).AND.(AGLMT2.LT.0.0D0)) GO TO 214
      IF ((AGLMT1.GE.0.0D0).AND.(AGLMT2.GE.0.0D0)) GO TO 215
      IF ((AGLMT2.LT.0.0D0).AND.(AGLMT1.GE.0.0D0)) GO TO 216
      IF ((AGLMT2.GE.0.0D0).AND.(AGLMT1.LT.0.0D0)) GO TO 218
      CALL PMDSTOP      
  214 IF ((ANGLE.LT.AGLMT1).AND.(ANGLE.GT.AGLMT2)) GO TO 321      
      GO TO 308  
C     IF THE POINT FALLS BETWEEN AGLMT1 AND AGLMT2,OMIT IT 
  215 IF ((ANGLE.GE.AGLMT1).AND.(ANGLE.LE.AGLMT2)) GO TO 308      
      GO TO 321  
  216 IF (DABS(AGLMT2).LT.PIO2) GO TO 217
      IF ((ANGLE.LT.0.0D0).AND.(J.GT.IFC/2)) GO TO 321
      IF ((ANGLE.GT.AGLMT1).AND.(ANGLE.LT.(AGLMT2+TWPI))) GO TO 321      
      GO TO 308  
  217 IF ((ANGLE.GE.AGLMT2).AND.(ANGLE.LE.AGLMT1)) GO TO 308
      GO TO 321
  218 IF (AGLMT1.GT.-PIO2) GO TO 219  
      IF ((ANGLE.GE.AGLMT1).AND.(ANGLE.LE.AGLMT2)) GO TO 308      
      GO TO 321  
  219 IF ((ANGLE.GE.AGLMT1).AND.(ANGLE.LE.AGLMT2)) GO TO 308      
      GO TO 321  
C     IF WE ARRIVE HERE,THE ECLIPSED STAR IS CENTERED AT YG,XG    
  280 A=X+XG     
      B=Y+YG     
      RDS=DSQRT(A**2+B**2)      
C     A,B are coods.of point rel. to center of star at YG,XG
      ANGLE=DACOS(B/RDS)
      IF (IRD.EQ.-1) ANGLE=PI-ANGLE
      IF (A.LT.0.0D0) ANGLE=-ANGLE
      IF ((DABS(AGLMT1-ANG).LE.ERLT).AND.(DABS(AGLMT2-ANG).LE.ERLT)) 
     $GO TO 308   
      IF ((AGLMT1.GE.0.0D0).AND.(AGLMT2.GE.0.0D0)) GO TO 282
      IF ((AGLMT1.LT.0.0D0).AND.(AGLMT2.LT.0.0D0)) GO TO 283
      IF ((AGLMT2.LT.0.0D0).AND.(AGLMT1.GE.0.0D0)) GO TO 284
      IF ((AGLMT2.GE.0.0D0).AND.(AGLMT1.LT.0.0D0)) GO TO 285
      CALL PMDSTOP      
  282 IF ((ANGLE.GE.AGLMT1).AND.(ANGLE.LE.AGLMT2)) GO TO 308      
      GO TO 321  
  283 IF ((ANGLE.GT.AGLMT1).AND.(ANGLE.LT.AGLMT2)) GO TO 321      
      GO TO 308  
  284 IF (AGLMT1.LT. PIO2) GO TO 386  
      IF ((ANGLE.GE.AGLMT2).AND.(ANGLE.LE.AGLMT1)) 
     $GO TO 308
      GO TO 321
  386 IF ((ANGLE.GT.AGLMT2).AND.(ANGLE.LT.AGLMT1)) 
     $GO TO 308      
      GO TO 321  
  285 IF  (AGLMT2.GT.PIO2) GO TO 288  
      IF ((ANGLE.LT.AGLMT2).AND.(ANGLE.GT.AGLMT1)) GO TO 321      
      GO TO 308  
  288 IF ((ANGLE.GE.AGLMT1).AND.(ANGLE.LE.AGLMT2)) GO TO 308      
      GO TO 321  
  308 IF (LCT(15).EQ.1) GO TO 78      
      Y=XP*CSPJ-YP*SNPJ
      X=XP*SNPJ+YP*CSPJ
      GO TO 310  
   78 CONTINUE   
      X=XP
      Y=YP
  310 CONTINUE
      WRITE (NOUT2, 193) X-XCM, -Y+YCM, 2.D0, 0
	K2CT=K2CT+1
      IF (ICOUNT.EQ.2) GO TO 321
      IF (J.NE.(IFC-1)) GO TO 321
      XNKSV2=X
      YNKSV2=Y
  321 CONTINUE
      RETURN
      END
