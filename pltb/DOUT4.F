      SUBROUTINE DOUT4(AGLMT1,I,IEC,IFC,ISV,AGLMT2,
     $IRC,NKP,XG,YG,ICOUNT,LCT,XCM,YCM,
     $CSPJ,ISEQ,SNPJ,KS,NOUT1,NOUT12)
	INCLUDE 'COMA.FOR'
      DIMENSION LCT(16)
      DATA PIO2/1.5707963267949D0/
      DATA ANG/6.29D0/
	DATA ERLT/1.D-13/
C*********************************************************************
C     DRAW OUTLINE      
C*********************************************************************
C  
C    IF I=ISV,WE HAVE THE STAR AT THE ORIGIN OF COODS.     
C
C
  193 FORMAT (2F12.5)
C     Now plot neck
      K=0
C     Plot neck only once
      IF (ICOUNT.EQ.2) GO TO 229
      IF (NKP.LE.1) GO TO 229
      DO 450 J=1,NKP-1
      AGL1=ALP(J,3)
      RG=(ALP(J+1,3)-ALP(J,3))/16.0D0
      JLM=16
      JKL=0
      IF (K.GT.0) GO TO 455
      JLM=17
      JKL=1
  455 DO 449 JJ=1,JLM
      CFF=JJ-JKL
      ANGLE=AGL1+CFF*RG
      JRF=3
      IF (ICOUNT.EQ.ISV) GO TO 723
      IF ((DABS(AGLMT1-ANG).LE.ERLT).AND.(DABS(AGLMT2-ANG).LE.ERLT)) 
     $GO TO 723
      IF (ISV.EQ.IEC) GO TO 790
      IF ((AGLMT1.GE.0.0D0).AND.(AGLMT2.GE.0.0D0)) GO TO 751
      IF ((AGLMT1.LT.0.0D0).AND.(AGLMT2.LT.0.0D0)) GO TO 752
      IF ((AGLMT2.LT.0.0D0).AND.(AGLMT1.GE.0.0D0)) GO TO 753
      IF ((AGLMT2.GE.0.0D0).AND.(AGLMT1.LT.0.0D0)) GO TO 755
      CALL PMDSTOP
  751 IF (ANGLE.GE.AGLMT1) GO TO 723
      GO TO 726
  752 IF (ANGLE.GE.AGLMT1) GO TO 723
      GO TO 726
  753 IF (DABS(AGLMT2).LT.PIO2) GO TO 754
      IF (ANGLE.GE.AGLMT2) GO TO 723
      GO TO 726
  754 IF (ANGLE.GE.AGLMT2) GO TO 723
      GO TO 449
  755 IF (AGLMT1.GT.-PIO2) GO TO 756
      IF (ANGLE.GE.AGLMT1) GO TO 723
      GO TO 726
  756 IF (ANGLE.GE.AGLMT1) GO TO 723
      GO TO 726
  790 IF ((AGLMT1.GE.0.0D0).AND.(AGLMT2.GE.0.0D0)) GO TO 792
      IF ((AGLMT1.LT.0.0D0).AND.(AGLMT2.LT.0.0D0)) GO TO 793
      IF ((AGLMT2.LT.0.0D0).AND.(AGLMT1.GE.0.0D0)) GO TO 794
      IF ((AGLMT2.GE.0.0D0).AND.(AGLMT1.LT.0.0D0)) GO TO 795
      CALL PMDSTOP
  792 IF (ANGLE.GE.AGLMT1) GO TO 726
      GO TO 723
  793 IF (ANGLE.GE.AGLMT1) GO TO 723
      GO TO 726
  794 IF (AGLMT2.GT.-PIO2) GO TO 796
      IF ((ANGLE.LE.AGLMT1).AND.(ANGLE.GE.AGLMT2)) GO TO 723
      GO TO 449
  796 IF ((ANGLE.GE.AGLMT2).AND.(ANGLE.LE.AGLMT1)) GO TO 723
      GO TO 726
  795 IF (AGLMT1.GT.-PIO2) GO TO 797
      IF (ANGLE.GE.AGLMT2) GO TO 723
      GO TO 726
  797 IF (ANGLE.GE.AGLMT1) GO TO 723
      GO TO 726
  723 CONTINUE
      CALL RHO(ANGLE,ARYA,ARYB,ARYC,ALP,RS,JRF,IRC,IFC,NKP,VRHO)
      A=VRHO*DCOS(ANGLE)
      B=VRHO*DSIN(ANGLE)
      YP=A
      IF ((I.NE.ISV).AND.(ISEQ.LT.3)) YP=-YP
      IF ((I.EQ.ISV).AND.(ISEQ.GT.2)) YP=-YP
      XP=B                                           
      IF (I.EQ.ISV) GO TO 725
      IF (ISV.NE.IEC) GO TO 745
      YP=YP-YG
      XP=XP-XG
      GO TO 725
  745 YP=YP+YG
      XP=XP+XG
  725 CONTINUE
      K=K+1
      XV(K)=XP
      YV(K)=YP
      IF (LCT(15).EQ.1) GO TO 449
      YV(K)=XP*CSPJ-YP*SNPJ
      XV(K)=XP*SNPJ+YP*CSPJ
  449 CONTINUE
  450 CONTINUE      
  726 IF ((ICOUNT.EQ.2).AND.(LCT(4).NE.1)) GO TO 229
      IF ((ICOUNT.EQ.1).AND.(LCT(12).NE.1)) GO TO 229
	IF (KS.GT.1) GO TO 229
      DO L=1,K
      X=XV(L)
      Y=YV(L)
      WRITE (NOUT12, 193) X-XCM, -Y+YCM
      END DO
  229 CONTINUE   
      RETURN
      END
