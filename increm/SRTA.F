      SUBROUTINE SRTA(X,Y,ARX,ARY,KY,NX)     
C     SRT TO SORT X INTO A TABLE OF X VALUES,IN ITS PROPER ORDINAL PLACE 
C     Y IS PLACED IN THE SAME RELATIVE POSITION IN THE CORRESPONDING     
C     TABLE OF Y VALUES 
C     LENGTHS OF ARRAYS ARE MAINTAINED FIXED 
C     NX IS THE LENGTH OF ARRAYS ARX AND ARY 
C     THE LAST ARRAY ENTRY IS LOST AS X IS INSERTED IN ARRAY,UNLESS X    
C     FOLLOWS LAST ENTRY.IN THAT CASE THE FIRST ENTRY IS LOST AND THE    
C     GIVEN X VALUE BECOMES THE LAST ENTRY   
C     IF KY=0,IT MAKES NO DIFFERENCE WHICH TABLE ENTRIES ARE LOST 
C     IF KY=1,SAVE FIRST TABLE ENTRY IF POSSIBLE    
C     IF KY=2,SAVE LAST TABLE ENTRY,IF POSSIBLE     
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      DIMENSION ARX(NX),ARY(NX)
      C=1.D0
      IF (ARX(2).LT.ARX(1)) C=-1.D0
      IF ((C*X).LT.(C*ARX(1))) GO TO 20      
      IF ((C*X).GT.(C*ARX(NX))) GO TO 12     
      DO 3 IS=1,NX      
      IF (X.EQ.ARX(IS)) GO TO 11
      IF ((C*ARX(IS)).GT.(C*X)) GO TO 4      
    3 CONTINUE   
C     IF ARRIVE HERE,X FOLLOWS LAST TABLE ENTRY     
   12 IS=NX-1    
      DO 31 IT=1,IS     
      ARX(IT)=ARX(IT+1) 
      ARY(IT)=ARY(IT+1) 
   31 CONTINUE   
      ARX(NX)=X  
      ARY(NX)=Y  
      GO TO 99   
C     IF ARRIVE HERE,THE CURRENT ARX(IS) IMMEDIATELY FOLLOWS X    
    4 IF (KY.EQ.0) GO TO 9     
      IF (KY.EQ.2) GO TO 8     
      GO TO 6    
    9 NL=NX/2    
      IF (IS.LE.(NX-NL)) GO TO 6      
    8 IS=IS-1    
C     SHIFT TABLE TO LOSE FIRST ENTRY 
      IF (IS.EQ.1) GO TO 50    
      IR=IS-1    
      DO 7 IT=1,IR      
      ARX(IT)=ARX(IT+1) 
      ARY(IT)=ARY(IT+1) 
    7 CONTINUE   
      GO TO 50   
C     SHIFT TABLE TO LOSE LAST ENTRY  
    6 NL=NX-1
      DO 5 IT=IS,NL     
      IR=NX-IT+IS
      ARX(IR)=ARX(IR-1) 
      ARY(IR)=ARY(IR-1) 
    5 CONTINUE   
   50 ARX(IS)=X  
      ARY(IS)=Y  
   99 RETURN     
C     IF ARRIVE HERE,X PRECEDES FIRST TABLE ENTRY   
   20 DO 21 IS=2,NX     
      IR=NX-IS+2 
      ARX(IR)=ARX(IR-1) 
      ARY(IR)=ARY(IR-1) 
   21 CONTINUE   
      ARX(1)=X   
      ARY(1)=Y   
      GO TO 99   
   11 IF (Y.EQ.ARY(IS)) GO TO 99
      GO TO 4
      END 
